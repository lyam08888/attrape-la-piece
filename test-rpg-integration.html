<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Intégration Interface RPG</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="rpgInterface.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            font-family: 'VT323', monospace;
        }
        
        .test-section {
            background: var(--rpg-bg-alpha);
            border: var(--rpg-border-width) solid var(--rpg-border);
            border-radius: var(--rpg-border-radius);
            padding: 20px;
            margin: 20px 0;
        }
        
        .test-button {
            background: var(--rpg-accent);
            color: var(--rpg-primary);
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-family: 'VT323', monospace;
            font-size: 16px;
        }
        
        .test-button:hover {
            background: var(--rpg-accent-light);
        }
        
        #gameCanvas {
            width: 100%;
            height: 400px;
            background: linear-gradient(180deg, 
                #FFE4B5 0%,    /* Paradis */
                #87CEEB 15%,   /* Ciel */
                #32CD32 30%,   /* Forêts */
                #9370DB 45%,   /* Cristaux */
                #DAA520 60%,   /* Plaines */
                #8B4513 75%,   /* Terres sombres */
                #8B0000 90%,   /* Enfer */
                #000000 100%   /* Abysse */
            );
            border: 2px solid var(--rpg-border);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <h1>🎮 Test d'Intégration - Interface RPG</h1>
    
    <div class="test-section">
        <h2>📊 État de l'Intégration</h2>
        <div id="integrationStatus">
            <p>⏳ Vérification en cours...</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>🎮 Simulation de Jeu</h2>
        <canvas id="gameCanvas"></canvas>
        <div style="margin-top: 10px;">
            <button class="test-button" onclick="initializeRPGInterface()">Initialiser Interface RPG</button>
            <button class="test-button" onclick="testWindows()">Tester Fenêtres</button>
            <button class="test-button" onclick="testNotifications()">Tester Notifications</button>
            <button class="test-button" onclick="testHUD()">Tester HUD</button>
        </div>
    </div>
    
    <div class="test-section">
        <h2>🪟 Tests des Fenêtres</h2>
        <button class="test-button" onclick="rpgInterface?.toggleWindow('inventoryWindow')">Inventaire (I)</button>
        <button class="test-button" onclick="rpgInterface?.toggleWindow('characterWindow')">Personnage (C)</button>
        <button class="test-button" onclick="rpgInterface?.toggleWindow('questWindow')">Quêtes (Q)</button>
        <button class="test-button" onclick="rpgInterface?.toggleWindow('mapWindow')">Carte (M)</button>
        <button class="test-button" onclick="rpgInterface?.toggleWindow('craftingWindow')">Artisanat (O)</button>
        <button class="test-button" onclick="rpgInterface?.toggleWindow('journalWindow')">Journal (J)</button>
        <button class="test-button" onclick="rpgInterface?.toggleWindow('settingsWindow')">Paramètres (ESC)</button>
    </div>
    
    <div class="test-section">
        <h2>🔔 Tests des Notifications</h2>
        <button class="test-button" onclick="testNotification('success')">Succès</button>
        <button class="test-button" onclick="testNotification('warning')">Avertissement</button>
        <button class="test-button" onclick="testNotification('error')">Erreur</button>
        <button class="test-button" onclick="testNotification('info')">Information</button>
    </div>
    
    <div class="test-section">
        <h2>📈 Statistiques de Test</h2>
        <div id="testStats">
            <p>Interface initialisée: <span id="interfaceStatus">❌</span></p>
            <p>Fenêtres créées: <span id="windowCount">0</span></p>
            <p>HUD actif: <span id="hudStatus">❌</span></p>
            <p>Raccourcis clavier: <span id="keyboardStatus">❌</span></p>
        </div>
    </div>

    <script type="module">
        import { RPGInterfaceManager } from './rpgInterfaceManager.js';
        
        let rpgInterface = null;
        window.rpgInterface = null;
        
        // Simulation d'un objet game
        window.game = {
            player: {
                health: 85,
                maxHealth: 100,
                mana: 60,
                maxMana: 100,
                stamina: 90,
                maxStamina: 100,
                level: 12,
                gold: 1247,
                experience: 750,
                experienceToNext: 1000
            }
        };
        
        // Fonctions de test
        window.initializeRPGInterface = function() {
            try {
                console.log("🎮 Initialisation de l'interface RPG de test...");
                rpgInterface = new RPGInterfaceManager();
                window.rpgInterface = rpgInterface;
                
                updateStatus('interfaceStatus', '✅');
                updateStatus('windowCount', rpgInterface.windows.size);
                updateStatus('hudStatus', '✅');
                updateStatus('keyboardStatus', '✅');
                
                rpgInterface.showNotification('Interface RPG initialisée avec succès !', 'success');
                console.log("✅ Interface RPG de test initialisée !");
            } catch (error) {
                console.error("❌ Erreur lors de l'initialisation:", error);
                rpgInterface.showNotification('Erreur lors de l\'initialisation', 'error');
            }
        };
        
        window.testWindows = function() {
            if (!rpgInterface) {
                alert('Veuillez d\'abord initialiser l\'interface RPG');
                return;
            }
            
            // Ouvrir quelques fenêtres pour le test
            rpgInterface.openWindow('inventoryWindow');
            setTimeout(() => rpgInterface.openWindow('characterWindow'), 200);
            setTimeout(() => rpgInterface.openWindow('questWindow'), 400);
            
            rpgInterface.showNotification('Fenêtres de test ouvertes', 'info');
        };
        
        window.testNotifications = function() {
            if (!rpgInterface) {
                alert('Veuillez d\'abord initialiser l\'interface RPG');
                return;
            }
            
            rpgInterface.showNotification('Test de notification réussi !', 'success');
            setTimeout(() => rpgInterface.showNotification('Attention: Test en cours', 'warning'), 1000);
            setTimeout(() => rpgInterface.showNotification('Information: Tout fonctionne', 'info'), 2000);
        };
        
        window.testNotification = function(type) {
            if (!rpgInterface) {
                alert('Veuillez d\'abord initialiser l\'interface RPG');
                return;
            }
            
            const messages = {
                success: 'Opération réussie !',
                warning: 'Attention requise',
                error: 'Une erreur est survenue',
                info: 'Information importante'
            };
            
            rpgInterface.showNotification(messages[type], type);
        };
        
        window.testHUD = function() {
            if (!rpgInterface) {
                alert('Veuillez d\'abord initialiser l\'interface RPG');
                return;
            }
            
            // Simuler des changements de stats
            window.game.player.health = Math.max(10, window.game.player.health - 15);
            window.game.player.mana = Math.min(100, window.game.player.mana + 10);
            
            rpgInterface.updateHUD();
            rpgInterface.showNotification('HUD mis à jour', 'info');
        };
        
        function updateStatus(elementId, value) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = value;
            }
        }
        
        // Vérification de l'intégration au chargement
        document.addEventListener('DOMContentLoaded', () => {
            const statusDiv = document.getElementById('integrationStatus');
            
            try {
                // Vérifier les fichiers CSS
                const cssLink = document.querySelector('link[href="rpgInterface.css"]');
                const hasFontAwesome = document.querySelector('link[href*="font-awesome"]');
                const hasVT323 = document.querySelector('link[href*="VT323"]');
                
                let status = '<h3>✅ Vérifications réussies:</h3><ul>';
                
                if (cssLink) status += '<li>✅ CSS Interface RPG chargé</li>';
                else status += '<li>❌ CSS Interface RPG manquant</li>';
                
                if (hasFontAwesome) status += '<li>✅ Font Awesome chargé</li>';
                else status += '<li>❌ Font Awesome manquant</li>';
                
                if (hasVT323) status += '<li>✅ Police VT323 chargée</li>';
                else status += '<li>❌ Police VT323 manquante</li>';
                
                status += '</ul>';
                
                status += '<h3>📋 Instructions:</h3>';
                status += '<ol>';
                status += '<li>Cliquez sur "Initialiser Interface RPG"</li>';
                status += '<li>Testez les différentes fenêtres avec les boutons</li>';
                status += '<li>Utilisez les raccourcis clavier (I, C, Q, M, O, J, ESC)</li>';
                status += '<li>Vérifiez les notifications et le HUD</li>';
                status += '</ol>';
                
                statusDiv.innerHTML = status;
                
            } catch (error) {
                statusDiv.innerHTML = `<p>❌ Erreur lors de la vérification: ${error.message}</p>`;
            }
        });
        
        // Test automatique après 2 secondes
        setTimeout(() => {
            console.log("🚀 Lancement du test automatique...");
            initializeRPGInterface();
        }, 2000);
    </script>
</body>
</html>